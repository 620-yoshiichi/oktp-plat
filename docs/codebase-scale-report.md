# コードベース規模算定レポート

**調査日**: 2026-01-20
**対象プロジェクト**: oktp_new (Next.js 統合業務管理システム)

---

## サマリー

| 項目 | 数値 | 規模感 |
|------|------|--------|
| **総コード行数** | 約 127,000 行 | 中〜大規模 |
| **ファイル数** | 956 個 | 多い |
| **ページ数** | 70+ ページ | 複数モジュール統合 |
| **データモデル数** | 66 モデル | 複雑なドメイン |
| **APIエンドポイント** | 44+ 個 | 充実 |
| **カスタムフック** | 67 個 | 高い再利用性 |
| **共通コンポーネント** | 224 個 | 大規模なUIライブラリ |

**総合評価**: 中〜大規模のエンタープライズ業務管理システム

---

## 1. アプリケーション構成

4つの独立した業務アプリケーションを1つのコードベースで統合:

| アプリ | 説明 | ページ数 |
|--------|------|---------|
| **QRBP** | QRコード・プロセス管理 | 13 |
| **ucar** | 車両管理・プロセス追跡 | 18 |
| **shinren** | レンタル管理 | 9 |
| **newCar** | 新車登録・管理 | 19 |
| **common** | 共通管理画面 | 11 |

---

## 2. ファイル構成

### ファイルタイプ別

| タイプ | 数量 |
|--------|------|
| TSX ファイル | 875 個 |
| TS ファイル | 78 個 |
| CSS ファイル | 5 個 |
| **合計** | **956 個** |

### ディレクトリ構造

```
/src
  ├── /app              # Next.js App Router
  │   ├── /(apps)       # 4つの業務アプリ
  │   ├── /api          # APIエンドポイント (44+)
  │   └── /(utils)      # ログイン等ユーティリティ
  ├── /cm               # 共通モジュール
  │   ├── /components   # 224個のコンポーネント
  │   ├── /hooks        # 67個のカスタムフック
  │   ├── /class        # 51個のユーティリティクラス
  │   └── /lib          # 20+のライブラリ
  └── /types            # 型定義
/prisma
  └── /schema           # 7つのPrismaスキーマ (66モデル)
```

---

## 3. 技術スタック

### フレームワーク
- **Next.js 16.1** + **React 19**
- **TypeScript 5.7**
- **TailwindCSS 4.1**
- **Prisma 7.2** (ORM)

### 主要ライブラリ
- **認証**: NextAuth
- **状態管理**: Jotai, SWR
- **UI**: Shadcn/ui, Radix UI, Recharts
- **フォーム**: React Hook Form
- **ファイル**: PDF-Lib, React CSV, Sharp

### 外部サービス連携
- **Google**: Calendar, Sheets, Drive, BigQuery, Gmail
- **OpenAI**: GPT API統合
- **AWS**: S3 (ファイルストレージ)

---

## 4. データベース構成

### Prismaスキーマ (7ファイル)
- `schema.prisma` - メイン
- `QRBP.prisma` / `ucar.prisma` / `shinren.prisma` / `newCar.prisma` - 各アプリ専用
- `ai21.prisma` / `delivery.prisma` - 補助

### 主要モデル (66個)
- **マスター**: User, Store, Area
- **業務**: Car, NewCar, Ucar, Process, RentaDeal
- **集計**: ProgressAggregationTable, UserProgressAggregationTable

---

## 5. 規模感の目安

### 他プロジェクトとの比較

| 規模 | コード行数 | 開発工数目安 |
|------|-----------|-------------|
| 小規模 | 〜10,000行 | 1〜3人月 |
| 中規模 | 10,000〜50,000行 | 3〜12人月 |
| **本プロジェクト** | **127,000行** | **12〜24人月相当** |
| 大規模 | 100,000行〜 | 24人月以上 |

### 複雑性の指標

| 指標 | 本プロジェクト | 評価 |
|------|---------------|------|
| モジュール数 | 5 アプリ | 高 |
| DB テーブル | 66 | 高 |
| API数 | 44+ | 中〜高 |
| 外部連携 | 3+ サービス | 中 |
| カスタムロジック | 67フック + 51クラス | 高 |

---

## 6. 特徴

1. **マルチアプリ統合**: 4つの業務システムを単一コードベースで管理
2. **高度なモジュール化**: 共通コンポーネント・フック・クラスの充実
3. **複雑なドメインモデル**: 車両管理、レンタル、新車登録等の業務ロジック
4. **外部サービス統合**: Google各種サービス、OpenAI、AWS
5. **PWA対応**: オフライン使用可能
6. **日本語ローカライズ**: 業務用語の日本語対応

---

## 7. 結論

このプロジェクトは **中〜大規模のエンタープライズ業務管理システム** です。

- **開発工数**: 12〜24人月相当の規模
- **保守難易度**: 中〜高（複数アプリ統合、66テーブル）
- **拡張性**: 高（共通モジュール化が進んでいる）

複数の独立した業務アプリケーションを統合し、共通モジュールで再利用性を高めた設計になっています。

---

## 8. ゼロからの構築工数概算

### 8.1 工数サマリー

| 項目 | 工数 |
|------|------|
| **総工数** | **18〜24人月** |
| **期間目安** | 6〜12ヶ月 |
| **推奨チーム規模** | 2〜4名 |

---

### 8.2 フェーズ別内訳

| フェーズ | 作業内容 | 工数 |
|---------|----------|------|
| **1. 要件定義・設計** | 業務フロー整理、DB設計、API設計、画面設計 | 2〜3人月 |
| **2. 環境構築** | Next.js/Prisma/認証/外部サービス連携基盤 | 1〜1.5人月 |
| **3. 共通モジュール開発** | コンポーネント(224個)、フック(67個)、クラス(51個) | 4〜5人月 |
| **4. DB・API開発** | 66モデル、44+エンドポイント | 2〜3人月 |
| **5. 業務アプリ開発** | 5アプリ・70+ページ | 6〜8人月 |
| **6. 外部連携** | Google API、OpenAI、AWS S3 | 1〜1.5人月 |
| **7. テスト・修正** | 結合テスト、UAT、バグ修正 | 2〜3人月 |
| **合計** | | **18〜24人月** |

---

### 8.3 業務アプリ別工数

| アプリ | ページ数 | 複雑度 | 工数 |
|--------|---------|--------|------|
| **共通基盤** | - | 高 | 3〜4人月 |
| **QRBP** | 13 | 中 | 1.5〜2人月 |
| **ucar** | 18 | 高 | 2〜2.5人月 |
| **shinren** | 9 | 中 | 1〜1.5人月 |
| **newCar** | 19 | 高 | 2〜2.5人月 |
| **common** | 11 | 低〜中 | 1〜1.5人月 |

---

### 8.4 開発体制案

#### パターンA: 小規模チーム（2名）
- 期間: 10〜12ヶ月
- 構成: フルスタック × 2名
- メリット: コミュニケーションコスト低
- デメリット: 期間長い

#### パターンB: 中規模チーム（3〜4名）
- 期間: 6〜8ヶ月
- 構成: リード1名 + フルスタック2〜3名
- メリット: バランス良い
- デメリット: 調整コストあり

#### パターンC: 分業チーム（4〜5名）
- 期間: 5〜6ヶ月
- 構成: PM1名 + フロント2名 + バックエンド2名
- メリット: 最短期間
- デメリット: 管理コスト高い

---

### 8.5 コスト概算

| 単価想定 | 総工数 | 概算コスト |
|----------|--------|-----------|
| 80万円/人月 | 18人月 | 約1,440万円 |
| 80万円/人月 | 24人月 | 約1,920万円 |
| 100万円/人月 | 18人月 | 約1,800万円 |
| 100万円/人月 | 24人月 | 約2,400万円 |

**概算レンジ: 1,400万〜2,400万円**

※外注の場合。内製の場合は人件費換算。

---

### 8.6 リスク要因（工数増加の可能性）

| リスク | 影響 | 対策 |
|--------|------|------|
| 業務要件の曖昧さ | +20〜30% | 要件定義フェーズの充実 |
| 外部API仕様変更 | +5〜10% | バッファ確保 |
| 技術的負債の蓄積 | +10〜20% | 定期的なリファクタリング |
| メンバー離脱 | +30〜50% | ドキュメント整備、ペア開発 |

---

### 8.7 補足

#### 前提条件
- Next.js/React経験者がいること
- 業務要件が明確であること
- デザインは既存を踏襲

#### 含まれない工数
- 詳細なUIデザイン作成
- インフラ構築（Vercel等のマネージドサービス利用想定）
- 運用・保守
- ユーザー研修

---

## 9. 総括

ゼロから同等のシステムを構築する場合:

| 項目 | 値 |
|------|-----|
| **必要工数** | 18〜24人月 |
| **推奨期間** | 6〜8ヶ月 |
| **推奨体制** | 3〜4名 |
| **概算コスト** | 1,400〜2,400万円 |

複数の業務アプリを統合した中〜大規模システムとして、相応の開発投資が必要なプロジェクトです。
